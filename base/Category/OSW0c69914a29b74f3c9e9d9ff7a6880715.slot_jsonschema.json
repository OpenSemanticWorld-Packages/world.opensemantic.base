{
    "@context": [
        {
            "arrival_date": {
                "@id": "Property:HasEndDate",
                "@type": "xsd:dateTime"
            },
            "creator": {
                "@id": "Property:HasCreator",
                "@type": "@id"
            },
            "descriptive_text": {
                "@id": "Property:HasDescriptiveText",
                "@type": "xsd:string"
            },
            "dispatch_date": {
                "@id": "Property:HasStartDate",
                "@type": "xsd:dateTime"
            },
            "included_items": {
                "@id": "Property:HasStatement",
                "@type": "@id",
                "@context": {
                    "item_instance_property": "Property:HasProperty",
                    "item_instance": "Property:HasObject"
                }
            },
            "recipient": {
                "@id": "Property:HasRecipient",
                "@type": "@id"
            },
            "recipient_abbreviation": {
                "@id": "Property:HasRecipientAbbreviation",
                "@type": "xsd:string"
            },
            "recipient_site": {
                "@id": "Property:HasDestination",
                "@type": "@id"
            },
            "recipient_contacts": {
                "@id": "Property:HasRecipientContact",
                "@type": "@id"
            },
            "sender": {
                "@id": "Property:HasSender",
                "@type": "@id"
            },
            "sender_abbreviation": {
                "@id": "Property:HasSenderAbbreviation",
                "@type": "xsd:string"
            },
            "sender_site": {
                "@id": "Property:HasOrigin",
                "@type": "@id"
            },
            "sender_contacts": {
                "@id": "Property:HasSenderContact",
                "@type": "@id"
            },
            "shipment_status": {
                "@id": "Property:HasStatus",
                "@type": "@id"
            },
            "shipping_service_provider": {
                "@id": "Property:HasShippingServiceProvider",
                "@type": "@id"
            },
            "tracking_reference": {
                "@id": "Property:HasTrackingReference",
                "@type": "xsdf:string"
            }
        },
        "/wiki/Category:Item?action=raw&slot=jsonschema"
    ],
    "allOf": [
        {
            "$ref": "/wiki/Category:Item?action=raw&slot=jsonschema"
        }
    ],
    "type": "object",
    "id": "shipment_root",
    "uuid": "0c69914a-29b7-4f3c-9e9d-9ff7a6880715",
    "title": "Shipment",
    "title*": {
        "en": "Shipment"
    },
    "description": "Items delivered from a sender to a recipient.",
    "description*": {
        "en": "Items delivered from a sender to a recipient.",
        "de": "Sendung, die von einem Absender an einen Empfänger zugestellt werden."
    },
    "optiones": {
        "copy_ignore": [
            "uuid",
            "label"
        ]
    },
    "required": [
        "type",
        "sender",
        "sender_abbreviation",
        "recipient",
        "recipient_abbreviation",
        "dispatch_date",
        "label",
        "creator",
        "shipment_status"
    ],
    "defaultProperties": [
        "arrival_date",
        "descriptive_text",
        "sender_site",
        "sender_contacts",
        "recipient_site",
        "recipient_contacts",
        "included_items",
        "tracking_reference",
        "shipping_service_provider"
    ],
    "properties": {
        "type": {
            "default": [
                "Category:OSW0c69914a29b74f3c9e9d9ff7a6880715"
            ]
        },
        "label": {
            "description": "An empty label will be replaced by the autogenerated label, based on sender, recipient, dispatch date and descriptive text.",
            "description*": {
                "de": "Ein leeres Label wird durch das automatisch generierte Label ersetzt, das auf Absender, Empfänger, Versanddatum und Beschreibungstext basiert."
            },
            "items": {
                "properties": {
                    "text": {
                        "watch": {
                            "uuid_": "shipment_root.uuid",
                            "descriptive_text_": "shipment_root.descriptive_text",
                            "sender_": "shipment_root.sender_abbreviation",
                            "recipient_": "shipment_root.recipient_abbreviation",
                            "dispatch_": "shipment_root.dispatch_date"
                        },
                        "dynamic_template": "{{{sender_}}}-{{{recipient_}}}-{{dateformat 'Ymd_His' dispatch_}}{{#if descriptive_text_}}-{{{descriptive_text_}}}{{/if}}",
                        "options": {
                            "dynamic_template": {
                                "override": "empty"
                            }
                        }
                    }
                }
            },
            "propertyOrder": 1
        },
        "descriptive_text": {
            "title": "Descriptive text",
            "title*": {
                "de": "Beschreibender Text"
            },
            "description": "Optional text to describe the sample shipment. Will be used in the automatically generated label",
            "description*": {
                "de": "Optionaler Text to describe the sample shipment. Wird in der automatisch erzeugten Beschreibung verwendet."
            },
            "type": "string",
            "default": "",
            "options": {
                "render": "never"
            },
            "propertyOrder": 2
        },
        "description": {
            "propertyOrder": 4
        },
        "dispatch_date": {
            "allOf": [
                {
                    "$ref": "/wiki/JsonSchema:StartDateTime?action=raw&slot=main"
                }
            ],
            "title": "Dispatch date",
            "title*": {
                "de": "Versanddatum"
            },
            "description": "Will be used in the autogenerated label.",
            "description*": {
                "de": "Wird im automatisch generierten Label verwendet."
            },
            "dynamic_template": "{{_now_}}",
            "options": {
                "dynamic_template": {
                    "override": "empty"
                }
            },
            "propertyOrder": 5
        },
        "creator": {
            "title": "Creator",
            "title*": {
                "de": "Ersteller"
            },
            "format": "dynamic_template",
            "dynamic_template": "{{_current_user_}}",
            "options": {
                "hidden": true
            },
            "eval_template": [
                {
                    "type": "mustache",
                    "mode": "render",
                    "value": "[[{{{creator}}}]]"
                }
            ]
        },
        "sender": {
            "title": "Sender organization",
            "title*": {
                "de": "Absender-Organisation"
            },
            "description": "Acronym of the organization is required to generate shipment label.",
            "description*": {
                "de": "Akronym der Organisation ist erforderlich für die Erstellung des Versandetikett."
            },
            "type": "string",
            "format": "autocomplete",
            "range": "Category:OSW3cb8cef2225e403092f098f99bc4c472",
            "default": null,
            "watch": {
                "sender_abbreviation": "shipment_root.sender_abbreviation"
            },
            "options": {
                "autocomplete": {
                    "query": "[[Category:OSW3cb8cef2225e403092f098f99bc4c472]]|?HasAbbreviation=abbreviation",
                    "field_maps": [
                        {
                            "source_path": "$",
                            "template": "{{{result.printouts.abbreviation.[0]}}}",
                            "target_path": "$(sender_abbreviation)"
                        }
                    ]
                }
            },
            "propertyOrder": 10
        },
        "sender_abbreviation": {
            "title": "Sender Abbreviation",
            "title*": {
                "de": "Versender-Abkürzung"
            },
            "type": "string",
            "options": {
                "hidden": true,
                "render": "never"
            }
        },
        "sender_site": {
            "title": "Sender site",
            "title*": {
                "de": "Absender-Standort"
            },
            "type": "string",
            "format": "autocomplete",
            "range": "Category:OSW473d7a1ed48544d1be83b258b5810948",
            "watch": {
                "sender_": "sender"
            },
            "options": {
                "autocomplete": {
                    "query": "[[Category:OSW473d7a1ed48544d1be83b258b5810948]][[-IsLocatedIn::$(sender_)]]"
                }
            },
            "propertyOrder": 12
        },
        "sender_contacts": {
            "title": "Sender contact(s)",
            "title*": {
                "de": "Absenderkontakt"
            },
            "type": "array",
            "format": "table",
            "eval_template": [
                {
                    "type": "mustache-wikitext",
                    "mode": "render",
                    "value": "<ul>{{#sender_contacts}}<li>[[{{.}}]]</li>{{/sender_contacts}}</ul>"
                }
            ],
            "items": {
                "title": "Contact person",
                "title*": {
                    "de": "Kontaktperson"
                },
                "type": "string",
                "format": "autocomplete",
                "$comment": "range: Person",
                "range": "Category:OSW44deaa5b806d41a2a88594f562b110e9",
                "watch": {
                    "sender_": "sender"
                },
                "options": {
                    "autocomplete": {
                        "query": "[[Category:OSW44deaa5b806d41a2a88594f562b110e9]][[HasOrganization::$(sender)]] OR [[Category:OSW44deaa5b806d41a2a88594f562b110e9]][[HasOu::$(sender_)]] "
                    }
                }
            },
            "propertyOrder": 14
        },
        "recipient": {
            "title": "Recipient organization",
            "title*": {
                "de": "Empfänger-Organisation"
            },
            "description": "Acronym of the organization is required to generate shipment label.",
            "description*": {
                "de": "Akronym der Organisation ist erforderlich für die Erstellung des Versandetikett."
            },
            "type": "string",
            "format": "autocomplete",
            "range": "Category:OSW3cb8cef2225e403092f098f99bc4c472",
            "default": null,
            "watch": {
                "recipient_abbreviation": "shipment_root.recipient_abbreviation"
            },
            "options": {
                "autocomplete": {
                    "query": "[[Category:OSW3cb8cef2225e403092f098f99bc4c472]]|?HasAbbreviation=abbreviation",
                    "field_maps": [
                        {
                            "source_path": "$",
                            "template": "{{{result.printouts.abbreviation.[0]}}}",
                            "target_path": "$(recipient_abbreviation)"
                        }
                    ]
                }
            },
            "propertyOrder": 22
        },
        "recipient_abbreviation": {
            "title": "Recipient Abbreviation",
            "title*": {
                "de": "Empfänger-Abkürzung"
            },
            "type": "string",
            "options": {
                "hidden": true,
                "render": "never"
            }
        },
        "recipient_site": {
            "title": "Recipient site",
            "title*": {
                "de": "Empfänger-Standort"
            },
            "type": "string",
            "format": "autocomplete",
            "range": "Category:OSW473d7a1ed48544d1be83b258b5810948",
            "watch": {
                "recipient_": "recipient"
            },
            "options": {
                "autocomplete": {
                    "query": "[[Category:OSW473d7a1ed48544d1be83b258b5810948]][[-IsLocatedIn::$(recipient_)]]"
                }
            },
            "propertyOrder": 23
        },
        "recipient_contacts": {
            "title": "Recipient contact(s)",
            "title*": {
                "de": "Empfängerkontakt"
            },
            "type": "array",
            "format": "table",
            "eval_template": [
                {
                    "type": "mustache-wikitext",
                    "mode": "render",
                    "value": "<ul>{{#recipient_contacts}}<li>[[{{.}}]]</li>{{/recipient_contacts}}</ul>"
                }
            ],
            "items": {
                "title": "Contact person",
                "title*": {
                    "de": "Kontaktperson"
                },
                "type": "string",
                "format": "autocomplete",
                "$comment": "range: Person",
                "range": "Category:OSW44deaa5b806d41a2a88594f562b110e9",
                "watch": {
                    "recipient_": "recipient"
                },
                "options": {
                    "autocomplete": {
                        "query": "[[Category:OSW44deaa5b806d41a2a88594f562b110e9]][[HasOrganization::$(recipient_)]] OR [[Category:OSW44deaa5b806d41a2a88594f562b110e9]][[HasOu::$(recipient_)]]"
                    }
                }
            },
            "propertyOrder": 24
        },
        "shipping_service_provider": {
            "title": "Shipping service provider",
            "title*": {
                "de": "Versanddienstleister"
            },
            "type": "string",
            "format": "autocomplete",
            "eval_template": [
                {
                    "type": "wikitext",
                    "mode": "render",
                    "value": "{{{shipping_service_provider}}}"
                }
            ],
            "$comment": "Company",
            "range": "Category:OSW5f4a3751d23e482d80fb0b72dcd6bc31",
            "options": {
                "autocomplete": {
                    "category": "Category:OSW5be796e8a33c4567be1f31453fa747e8"
                }
            },
            "propertyOrder": 50
        },
        "tracking_reference": {
            "title": "Tracking reference",
            "title*": {
                "de": "Sendungsnummer"
            },
            "type": "string",
            "eval_template": [
                {
                    "type": "wikitext",
                    "mode": "render",
                    "value": "{{{tracking_reference}}}"
                }
            ],
            "propertyOrder": 60
        },
        "shipment_status": {
            "title": "Status",
            "title*": {
                "de": "Status"
            },
            "description": "Status of the shipment, e.g., \"In transit\".",
            "description*": {
                "de": "Status der Sendung, z.B. \"In Transit\"."
            },
            "type": "string",
            "format": "autocomplete",
            "range": "Category:OSWf8bf7b1902d94125ad8c20590087c4f6",
            "default": "Item:OSWaf335426cb8e44e9a3b109bcdc881bb4",
            "propertyOrder": 70
        },
        "arrival_date": {
            "allOf": [
                {
                    "$ref": "/wiki/JsonSchema:EndDateTime?action=raw&slot=main"
                }
            ],
            "title": "Arrival date",
            "title*": {
                "de": "Ankunftsdatum"
            },
            "propertyOrder": 80
        },
        "included_items": {
            "type": "array",
            "format": "table",
            "title": "Item(s)",
            "title*": {
                "de": "Sendungsinhalt"
            },
            "options": {
                "enable_array_copy": true,
                "array_copy_ignore": [
                    "uuid",
                    "attachments"
                ]
            },
            "eval_template": [
                {
                    "type": "mustache-wikitext",
                    "mode": "render",
                    "value": "{{=<% %>=}} <ul><%#included_items%><li>[[<%item_instance%>]] ({{#switch:{{USERLANGUAGECODE}}|en=Type|de=Typ|#default=Type}}: {{#ask:[[<%item_instance%>]]|?HasType=|format=plain|mainlabel=-}})</li><%/included_items%></ul>"
                }
            ],
            "items": {
                "type": "object",
                "format": "grid-strict",
                "title": "Item",
                "title*": {
                    "de": "Item"
                },
                "id": "included_item",
                "defaultProperties": [],
                "required": [
                    "uuid",
                    "item_type",
                    "item_instance_property",
                    "item_instance"
                ],
                "properties": {
                    "uuid": {
                        "title": "UUID",
                        "title*": {
                            "de": "UUID"
                        },
                        "type": "string",
                        "$comment": "format uuid field are copied, if not set in copy_ignore",
                        "_format": "uuid",
                        "_template": "dynamic_template",
                        "dynamic_template": "{{_uuid_}}",
                        "options": {
                            "hidden": true,
                            "dynamic_template": {
                                "override": "empty"
                            }
                        }
                    },
                    "item_type": {
                        "title": "Type",
                        "title*": {
                            "de": "Typ"
                        },
                        "type": "string",
                        "format": "autocomplete",
                        "range": "Category:Category",
                        "options": {
                            "autocomplete": {
                                "query": "[[:Category:Item]]OR[[SubClassOf::Category:Item]]OR[[SubClassOf.SubClassOf::Category:Item]]OR[[SubClassOf.SubClassOf.SubClassOf::Category:Item]]OR[[SubClassOf.SubClassOf.SubClassOf.SubClassOf::Category:Item]]OR[[SubClassOf.SubClassOf.SubClassOf.SubClassOf.SubClassOf::Category:Item]]"
                            },
                            "grid_columns": 12
                        },
                        "default": "Category:Item",
                        "propertyOrder": 40
                    },
                    "item_instance_property": {
                        "type": "string",
                        "default": "Property:HasPart",
                        "options": {
                            "hidden": true
                        }
                    },
                    "item_instance": {
                        "title": "Instance",
                        "title*": {
                            "de": "Instanz"
                        },
                        "type": "string",
                        "format": "autocomplete",
                        "range": "Category:Item",
                        "watch": {
                            "item_type_": "included_item.item_type"
                        },
                        "options": {
                            "autocomplete": {
                                "query": "[[HasType::$(item_type_)]]|?Display_title_of=label|?HasImage=image|?HasDescription=description"
                            },
                            "grid_columns": 12
                        },
                        "propertyOrder": 50
                    }
                }
            },
            "propertyOrder": 90
        }
    }
}